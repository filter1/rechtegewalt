<!DOCTYPE html>
<html lang="de">
    <head>
        <script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>
        <script src="https://rawgit.com/DmitryBaranovskiy/raphael/master/raphael-min.js"></script>
        <script src="https://rawgit.com/kartograph/kartograph.js/master/dist/kartograph.min.js"></script>

        <!-- Tooltips -->
        <link rel="stylesheet" type="text/css" href="http://cdn.jsdelivr.net/qtip2/2.2.1/jquery.qtip.min.css">
        <script src="http://cdn.jsdelivr.net/qtip2/2.2.1/jquery.qtip.min.js"></script>

        <!-- Bootstrap -->
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">

        <!-- Latest compiled and minified JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

        <meta name="viewport" content="width=device-width, initial-scale=1">

        <meta charset="utf-8">

        <title>Rechte Gewalt in Sachsen-Anhalt</title>

        <style type="text/css">
            html, body, .container-fluid, .row, .col-xs-6, .col-md-3 {
                height: 100%;
            }

            .fullHeight {
                height: 98%;
                margin: 1% 0;
                overflow: auto;
            }

            a, a:hover {
                color: #333333;
            }

        </style>

    </head>

    <body>
        <script type="text/javascript">
            function fillText(location, incidents, n) {

                $( "#text" ).html('<h2>' + location + ' <small>' + n +'</small></h2>');
                for (var i = incidents.length - 1; i >= 0; i--) {
                    var mydate = new Date(incidents[i].date);
                    $( "#text" ).append( "<p><small>" + mydate.toLocaleDateString('de-DE', { day: "numeric", year: "numeric", month: "short" }) + "</small></p>" );
                    $( "#text" ).append( "<p>" + incidents[i].text + "</p>" );
                    $( "#text" ).append( "<p><small>Quelle: " + incidents[i].source + "</small></p><hr>" );
                }
            };

            $(function() {
                // initialize tooltips
                $.fn.qtip.defaults.style.classes = 'qtip-light';

                $.fn.qtip.defaults.style.def = false;

                var map = kartograph.map('#map');
                map.loadMap('map.svg', function() {

                    map.addLayer('roads', {
                        styles: {
                            stroke: 'grey',
                            fill: 'white',
                        }
                    });
 
                    $.ajax({
                        url: 'cities.json',
                        dataType: 'json',
                        success: function(cities) {


                            var scale = kartograph.scale.sqrt(cities.concat([{ n: 0 }]), 'n').range([2, 20]);
                            map.addSymbols({
                                type: kartograph.Bubble,
                                data: cities,
                                location: function(city) {
                                    return [city.lng, city.lat];
                                },
                                radius: function(city) {
                                    return scale(city.n);
                                },
                                tooltip: function(city) {
                                    return '<h3>'+city.location+'</h3>'+city.n+' Vorf채lle';
                                },
                                click: function(data, path, event) {
                                    fillText(data.location, data.incidents, data.n);
                                },

                                sortBy: 'radius desc',
                                style: 'fill:#800; stroke: #fff; fill-opacity: 0.5;',
                            });
                        }
                    });
                });
            });

        </script>
        
        <div class="container-fluid">
            <div class="row">
                <div class="col-xs-6 col-md-3">
                    <div class="page-header">
                      <h1>Rechte Gewalt<br><small>in Sachsen-Anhalt</small></h1>
                    </div>

                    <br>
                    <p>Ab 2003 wurden in Sachsen-Anhalt 체ber 850 Straften rechter Gesinnung dokumentiert.</p>

                    <p>Klick auf die Kreise, um 체ber die Bericht der Vorf채lle zu lesen.</p>

                    <br><br><br>

                    <small>
                    <p>Daten: <a href="http://www.mobile-opferberatung.de/monitoring/">Mobile Opferberatung</a></p>

                    <p>Idee und Umsetzung: <a href="http://johannesfilter.com">Johannes Filter</a></p>

                    <p>Framework: <a href="http://kartograph.org">Kartograph.js</a></p>

                    <p>
                        This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.
                    </p>
                    </small>
                </div>
                <div class="col-xs-6 col-md-6">
                    <div class="fullHeight" id="map">
                    </div>
                </div>
                <div class="col-xs-6 col-md-3">
                    <div  class="fullHeight" id="text"></div>
                </div>
            </div>
        </div>
    </body>
</html>